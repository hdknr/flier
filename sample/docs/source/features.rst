============================
如水会システム機能概要
============================

.. contents::
    :local:


アカウントシステム
===================

XOOPSシステムユーザーのDjangoシステムユーザーへの移行
--------------------------------------------------------

- XOOPSユーザーをDjangoシステムのユーザーに移行します
- 移行時はログインできないようなパスワードが設定されます


新規ユーザーのプロビジョニング
--------------------------------------------------------

- AS400からのデータ登録により、如水会番号をID, 生年月日をパスワードとして
  新規ユーザーがDjangoシステムユーザーにプロビジョニングされます

システムログイン
-----------------------------------

- DjangoシステムユーザーのIDパスワードでログインできます。
- ログインできないが、Xoopsユーザーが存在する場合、「 :ref:`features.account.xoopslogin` 」
  でログインを試みます。

.. _features.account.xoopslogin:

既存XOOPSユーザーのログイン
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

- システム移行後の新規登録ユーザーには存在しません。
- 既存のIDパスワードでログイン
- ログイン時にパスワードをDjangoシステムのパスワードに設定します

パスワード変更
------------------

パスワードリセット(パスワードわすれ)
---------------------------------------------------------

- パスワードをリセットし、確認URL付きメールを送ります
- 確認URLでアクセスしたら新パスワードを設定します
- その後、新パスワードでログインします( :ref:`features.alumni.provisioning`)

Web名簿システム
===================

XOOPSシステムWeb名簿のDjangoシステムWeb名簿へのデータ移行
-----------------------------------------------------------

AS/400からのデータ登録
------------------------------------

- AS/400から出力されたCSV形式のデータでWeb名簿データの登録、更新、削除を行います

.. _features.alumni.provisioning:

ユーザーのプロビジョニング
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

- Web名簿の「如水会番号」に相当するユーザーIDのユーザーが存在しない場合、
  この番号をユーザーIDとしてユーザーを新規作成します
- パスワードはYYYYMMDDの生年月日が設定されまされます
- 電子メールアドレスは、1) LTMA, 2) 自宅メールアドレス, 3)勤務先メールアドレス
  の順番でWeb名簿データから設定されます

  .. note::
    - 200 <https://trac.ic-tact.co.jp/system/ticket/200>`)
    

プライバシー管理
------------------

- Web名簿は一般データベースと、管理者向けデータベースの２つで管理する
- AS/400での属性指定により2段階でプライバシー管理します

    1. 一般向けデータを用意しない 
    2. 一般向けデータを用意するが、指定された個人属性は載せない


名簿検索
-----------------

- システム管理者は管理者受けデータベースより検索します(管理者検索)
- それ以外のユーザーは一般データベースより検索します(一般検索)


組織一覧検索
-----------------

- 指定した組織を検索し、 名簿検索を絞ることができます


同報メール送信
------------------

- 検索した条件の如水会員に対して同報メールを送ります

生涯メール
===================

XOOPSシステム生涯メールアドレスのDjangoシステム生涯メールアドレスへのデータ移行
-----------------------------------------------------------------------------------

新規登録
-------------

転送アドレス変更
----------------------------

メール転送
------------

.. _features.community:

支援システム
===================

- 支部会、クラス会などのグループ管理、並びにグループごとのメンバー管理、
  情報共有を行います
    
XOOPS支援システムのDjango支援システムへのデータ移行
---------------------------------------------------------------

コミュニティ管理
---------------------------------------------------------------

- 支部会、クラス会などがコミュニティになります
- システム管理者は支部の追加/更新/削除ができます
- CSV/Excelファイルにより一括 追加/更新ができます
- コミュニティの一覧の閲覧に関しては、 フラグで設定します

コミュニティ管理者の管理
---------------------------------------------------------------

- システム管理者はコミュニティ管理者の追加/更新/削除ができます
- CSV/Excelファイルにより一括 追加/更新ができます
- コミュニティ管理者は実際の管理を行える権限の有無が指定できます
- 「 :ref:`features.community.admin_mail` 」 でメールを受け取る属性の有無を指定できます


コミュニティメンバーの管理
---------------------------------------------------------------

- システム管理者はコミュニティメンバーの追加/更新/削除ができます
- コミュニティ管理者は自身のコミュニティメンバーの追加/更新/削除ができます
- 如水会番号が指定されるとシステム内部ではユーザー、Web名簿などと紐付けされます

プロスペクトメンバー
^^^^^^^^^^^^^^^^^^^^^^^^^

- 実際の入会前のメンバーはプロスペクトとして扱います

個人属性のプライバシー管理
----------------------------------------

- 公開範囲を管理することができます

.. _features.community.member_mail:

コミュニティ同報メール送信
---------------------------------------------------------------

- コミュニティ管理者、システム管理者はメンバーに同報メールを送信することができます

.. _features.community.admin_mail:

コミュニティ管理者同報メール送信
---------------------------------------------------------------

- システム管理者はコミュニティ管理者に同報メールを送信することができます

課金管理
-------------------------

- コミュニティ管理者は、 如水会番号を持っているメンバーごとの金額を指定して、
  一括引き落としの依頼をすることが可能です

活動予定
-------------------------

- コミュニティ管理者はコミュニティの活動予定の登録管理を行うことができます

活動予定閲覧
^^^^^^^^^^^^^^^^^^^^

- メンバーは活動予定を閲覧することができます。
- メンバー以外の閲覧に関してはコミュニティ管理者が設定可能です   
  (ゲスト、如水会会員、 コミュニティメンバー、での閲覧に関しての権限設定がされます)

活動報告
-------------------------

- コミュニティ管理者はコミュニティの活動報告の登録管理を行うことができます
- 報告には写真などのファイルを添付することができます

活動報告閲覧
^^^^^^^^^^^^^^^^^^^^

- メンバーは活動報告を閲覧することができます。
- メンバー以外の閲覧に関してはコミュニティ管理者が設定可能です   
  (ゲスト、如水会会員、 コミュニティメンバー、での閲覧に関しての権限設定がされます)

アーカイブ
=====================

会報システム
--------------------

- システムデータを移行して、同様の操作を行えるようにする

留学生レポート
--------------------

- 会報システムと同様に管理できるようにする

講演データベース
--------------------------------

- 会報システムと同様に管理できるようにする

.. todo::
    - 仕様に関して玉川さんと確認中


一橋クラブ予約  
=====================

宴会予約
-----------

- 管理者は予約状況の登録ができる
- 如水会会員は空いている日時でWebから予約できる
- 管理者は予約状況をダウンロードすることができる  

.. note::
    - 実際の管理は14Fの担当者がExcelで管理している
    - 電話予約はExcelで行う


会議室予約
-----------

- 如水会会員は空いている日時でWebから予約できる
- 如水会会員は自身の指定した予約をキャンセルすることができる
- 管理者は予約状況をWeb画面より確認修正可能

一般会員予約条件
^^^^^^^^^^^^^^^^^^^^^^^^

- 予約時間範囲: 10:00 - 21:00
- 予約制限: 当月 + 3ヶ月まで
- 別の予約の前後の30分は予約は不可能
- 同一如水会番号での複数の予約は不可能 
 

イベント
=====================

- システム管理者は如水会のイベントスケジュールの追加/更新/削除を行うことができる
- イベントにはカテゴリを設けてカテゴリ別で管理できるようにする

.. todo::
    - 大学との連携は現時点で方式未定 

.. todo::
    - 如水会内部のスケジュール管理をどうするか？
    - 現在のスケジュール共有方式と、利用状況に関して玉川さんに問い合わせ中

オリジナルグッズ
==============================

購入
-----

- グッズの一覧表示
- グッズの購入選択
- 選択したグッズの購入依頼

トランザクション管理
------------------------

- 購入依頼のステータス変更

マスター管理
----------------

- グッズの登録/更新

問い合わせ・異動フォーム
==========================

会員からの問い合わせ異動に関しての受付管理を行う
業務区分(晩餐、行事、異動・変更、受講、講義、名簿、入会申し込み)ごとにフォームとデータを管理する

登録
-----

- ログインユーザーに関しては、個人情報を埋める
- 登録後本人、事務局にメールを送る

管理
----

- 消し込み、一括ダウンロードなどの管理機能
- メールの文面修正


Wordpress連携
====================

認証連携
--------------

- Djangoシステムでログイン時に、Wordpressユーザーのプロビジョニングを行う
- 同時に認証共有クッキーを発行する
- Wordpressに用意したプラグインが認証共有クッキーを判定してログインクッキーを設定することこで認証を行う   


データ連携
--------------

- 必要であればDjangoシステム側にJSONデータをフィードするAPIを用意する
- Wordpress側ではAjax/jQueryでJSONデータを処理して画面表示する


メールシステム
================= 

同報メール
---------------

- CSVでアップロードしたアドレス一覧にメールを送信する

バウンス管理
----------------

- エラーメールのバウンスをアドレスごとに管理します

メール転送
-------------

- 主に生涯メール転送に使います
